# NOMAD template with main information about the process, based on
# https://github.com/FAIRmat-NFDI/AreaA-data_modeling_and_schemas/blob/main/melt_czochralski_Dadzis/melt_czochralski.schema.archive.yaml
# https://github.com/FAIRmat-NFDI/AreaA-data_modeling_and_schemas/blob/main/melt_czochralski_Dadzis/melt_czochralski.data.archive.yaml

definitions:
  name: 'Electronic Lab Notebook' 
  sections:  # Schemas consist of section definitions
    MeltCzochralski:  
      # Inheriting it from EntryData, makes this section a possible
      # EntryArchive.data sub-section
      base_sections: 
      - nomad.datamodel.metainfo.eln.ElnBaseSection
      - nomad.datamodel.data.EntryData
      m_annotations:
        eln:
          hide: [name, description]
          lane_width: 200px
      sub_sections:
        users:
          section:
            quantities:
              user:
                type: User
                shape: ['*']
                m_annotations:
                  eln:
                    component: AuthorEditQuantity
        process:
          section:
            base_section: ../upload/raw/base_classes.schema.archive.yaml#Process 
            sub_sections:
              procedure:
                repeats: true
                section: 
                  base_section: ../upload/raw/base_classes.schema.archive.yaml#Procedure_step
                  quantities:
                    crystal_diameter:
                      type: str
                      m_annotations:
                        eln:
                          component: StringEditQuantity
                    # keep listing other useful parameters here
        configuration:
          section:
            m_annotations:
              eln:
                lane_width: 200px
            sub_sections:
              furnace:
                section:
                  m_annotations:
                    eln:
                      lane_width: 200px
                  quantities:
                    furnace_type:
                      type: str
                      description: "Furnace description"
                      m_annotations:
                        eln:
                          component: StringEditQuantity
              heating:
                section:
                  m_annotations:
                    eln:
                      lane_width: 200px
                  quantities:
                    heater_type:
                      type:
                        type_kind: Enum
                        type_data:
                          - Resistance
                          - Inductor
                      m_annotations:
                        eln:
                          component: EnumEditQuantity
                    heater_id:
                      type: str
                      description: "Inductor or resistance heater name or ID"
                      m_annotations:
                        eln:
                          component: StringEditQuantity
        data_processing:
          section:
            quantities:
              software:
                type: str
                m_annotations:
                  eln:
                    component: StringEditQuantity
                description: "Software used for logging"
              sampling_time:
                type: np.float64
                unit: ms
                m_annotations:
                  eln:
                    component: NumberEditQuantity
                    defaultDisplayUnit: ms
                description: "Time between sampled points"
              image_time:
                type: np.float64
                unit: ms
                m_annotations:
                  eln:
                    component: NumberEditQuantity
                    defaultDisplayUnit: ms
                description: "Time between recorded images"
        instrumentation:
          section:
            m_annotations:
              eln:
                lane_width: 200px
            sub_sections: {}
              # templates form below will be inserted here

instrumentation_IR-camera_template:
  section:
    m_annotations:
      eln:
        lane_width: 200px
    quantities:
      ir_camera:
        type: ../upload/raw/IRcameras.archive.yaml#IR_camera  # this will be replaced
instrumentation_camera_template:
  section:
    m_annotations:
      eln:
        lane_width: 200px
    quantities:
      camera:
        type: ../upload/raw/IRcameras.archive.yaml#IR_camera  # this will be replaced
instrumentation_sensors_template:
  section:
    m_annotations:
      eln:
        lane_width: 200px
      # plot:
      #   title: Sensors for growth monitoring
      #   x: time
      #   y: 
      #     - TE_1_front
      #     - TE_2_vessel
    quantities:
      sensors_locations:
        type: str
        description: Picture of sensor locations
        m_annotations:
          browser:
            adaptor: RawFileAdaptor  # Allows to navigate to files in the data browser
          eln:
            component: FileEditQuantity
      sensors_list:
        type: ../upload/raw/Sensors.archive.yaml#Sensors_list  # this will be replaced
        #shape: ['*']

data:  
  m_def: MeltCzochralski
  process:
    # activity_identifier: my_id
    # activity_method: Melt Czochralski
    start_time: "2021-03-04 10:15:00+01"  # will be set automatically
    # activity_category: crystal growth synthesis
    # end_time: 2021-03-04 10:15:00+01
    # location: Berlin
  data_processing:
    software: multilog vXXX  # will be set automatically
    sampling_time: -1  # will be set automatically
    image_time: -1  # will be set automatically
  instrumentation:
    {}
    # furnace:
    #   furnace_type: Test-Cz
    # heating:
    #   heater_type: 
    #   heater_id: vXXX

    # the cameras, sensors will be added here automatically
    # examples:
    # Optris-IP-640: # TODO fill name here
    #   ir_camera: ../upload/raw/IRcameras.archive.yaml#data # TODO fill name here
    # sensors: # TODO fill name here
    #   sensors_locations: sensor_geometry.png # TODO fill name here
    #   sensors_list: ../upload/raw/Sensors.archive.yaml#data # TODO fill name here
  
